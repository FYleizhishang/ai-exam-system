<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>正在学习...</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #000; color: white; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .video-box { flex: 1; width: 100%; }
        iframe { width: 100%; height: 100%; border: none; }
        .ctrl-bar { padding: 15px; background: #1c1c1e; display: flex; justify-content-between; align-items: center; }
    </style>
</head>
<body>

<div class="video-box">
    <iframe id="player" src="" allowfullscreen></iframe>
</div>

<div class="ctrl-bar">
    <div>
        <h5 class="m-0" id="title">Java 高并发编程实战</h5>
        <small class="text-muted">已学习 <span id="time" class="text-success">0</span> 分钟</small>
    </div>
    <button class="btn btn-outline-light btn-sm" onclick="history.back()">退出学习</button>
</div>

<script>
    const url = localStorage.getItem("curVideo");
    const cid = localStorage.getItem("curCid");
    const user = localStorage.getItem("username");

    if(url) document.getElementById('player').src = url;

    // 模拟记录时长
    let min = 0;
    setInterval(() => {
        min++;
        document.getElementById('time').innerText = min;
        // 每分钟向后端汇报一次
        if(min % 1 === 0) {
            fetch(`/api/course/log?u=${user}&cid=${cid}&p=${min*5}`, {method:'POST'});
        }
    }, 60000); // 真实是60000(1分钟)，为了演示你可以改小
</script>
</body>
</html>